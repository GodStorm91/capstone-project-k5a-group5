<!--
You are free to copy and use this sample in accordance with the terms of the
Apache license (http://www.apache.org/licenses/LICENSE-2.0.html)
-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>Google Maps V3 API Sample</title>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script src="http://code.jquery.com/jquery-migrate-1.1.0.min.js"></script>
    <script type="text/javascript">


    </script>

  </head>
  <body style="font-family: Arial; border: 0 none;">
    <div id="map-canvas" style="width: 800px; height: 800px;float:left;"></div>
	<div id="directionsPanel" style="float:left;width:400px;font-size:10px;"></div>
  </body>
	<script>
		var xml = "<plans><plan id = '1'><wpt lat='10.80079' lon='106.6613'/><wpt lat='10.80023' lon='106.6673' /><wpt lat='10.80139' lon='106.6683' /><wpt lat='10.80167' lon='106.6657' /><wpt lat='10.8027' lon='106.6668' /><wpt lat='10.80382' lon='106.6658' /><wpt lat='10.80439' lon='106.6661' /><wpt lat='10.80481' lon='106.6663' /><wpt lat='10.80486' lon='106.6646' /><wpt lat='10.80348' lon='106.6626' /><wpt lat='10.80079' lon='106.6613' /></plan><plan id='2'><wpt lat='10.80097' lon='106.66' /><wpt lat='10.80137' lon='106.6531' /><wpt lat='10.80118' lon='106.6554' /><wpt lat='10.80147' lon='106.6545' /><wpt lat='10.80432' lon='106.6548' /><wpt lat='10.80618' lon='106.6552' /><wpt lat='10.80531' lon='106.6587' /><wpt lat='10.80458' lon='106.661' /><wpt lat='10.80556' lon='106.6614' /><wpt lat='10.80097' lon='106.66' /></plan><plans>";
		//var xmls= '<plans><plan id = "1"><wpt lat="10.80079" lon="106.6613" /><wpt lat="10.80023" lon="106.6673" /><wpt lat="10.80139" lon="106.6683" /><wpt lat="10.80167" lon="106.6657" /><wpt lat="10.8027" lon="106.6668" /><wpt lat="10.80382" lon="106.6658" /><wpt lat="10.80439" lon="106.6661" /><wpt lat="10.80481" lon="106.6663" /><wpt lat="10.80486" lon="106.6646" /><wpt lat="10.80348" lon="106.6626" /><wpt lat="10.80079" lon="106.6613" /> </plan><plan id="2"><wpt lat="10.80097" lon="106.66" /><wpt lat="10.80137" lon="106.6531" /><wpt lat="10.80118" lon="106.6554" /><wpt lat="10.80147" lon="106.6545" /><wpt lat="10.80432" lon="106.6548" /><wpt lat="10.80618" lon="106.6552" /><wpt lat="10.80531" lon="106.6587" /><wpt lat="10.80458" lon="106.661" /><wpt lat="10.80556" lon="106.6614" /><wpt lat="10.80097" lon="106.66" /></plan><plans>';

		var wpt = new Array();
		var i = 0;
		$(xml).find("plan").each(function() {
			var points= new Array();
			points.length = 0;
			var lats = new Array();
			var lons = new Array();
			j=0;
			var id = $(this).attr("id");
			$(this).find("wpt").each(function(){
				lats[j] = ($(this).attr("lat"));
				lons[j] = ($(this).attr("lon"));
				points.push({location: new google.maps.LatLng(lats[j],lons[j])});
				j++;
			});	
			wpt[i] = points;
			i++;	
		});	
			var map;
		  function initialize() {
			var mapDiv = document.getElementById('map-canvas');
			map = new google.maps.Map(mapDiv, {
			  center: new google.maps.LatLng(10.80079, 106.6613),
			  zoom: 8,
			  mapTypeId: google.maps.MapTypeId.ROADMAP
			});
			
			stepDisplay = new google.maps.InfoWindow();
			for(var i =0;i< wpt[0].length-1;i++)
			{
				var icon = "https://chart.googleapis.com/chart?chst=d_map_pin_letter&chld=" + i + "|FF0000|000000";
				var text = "location" + i;
				var marker = new google.maps.Marker({
					position : wpt[0][i].location,
					map : map,
					icon: icon
				});
				attachInstructionText(marker, text);
			}
			
			for(var i =0;i< wpt[1].length-1;i++)
			{
				var icon = "https://chart.googleapis.com/chart?chst=d_map_pin_letter&chld=" + i + "|CCCCCC|000000";
				var text = "location" + i;
				var marker = new google.maps.Marker({
					position : wpt[1][i].location,
					map : map,
					icon: icon
				});
				attachInstructionText(marker, text);
			}
			var a = wpt.length;
			//direction 1
			var polylineOptionsActual = new google.maps.Polyline({
			strokeColor: '#FF0000',
			strokeOpacity: 0.5,
			strokeWeight: 5,
			map:map
			});
			directions = new google.maps.DirectionsService();
			  displayer = new google.maps.DirectionsRenderer({
				draggable: false,
				suppressMarkers : true,
				polylineOptions: polylineOptionsActual
			  });
			displayer.setMap(map);
			displayer.setPanel(document.getElementById("directionsPanel"));
			var ppt = [
				wpt[0][1],wpt[0][2],wpt[0][3],wpt[0][4],wpt[0][5],wpt[0][6],wpt[0][7],wpt[0][8]
				]
			directions.route({
			  origin: new google.maps.LatLng(10.80079, 106.6613),
			  destination: new google.maps.LatLng(10.80079, 106.6613),
			  travelMode: google.maps.DirectionsTravelMode.DRIVING,
			  waypoints: ppt
			}, function (result) {
			  displayer.setDirections(result);
			});
			//end direction 1
			//direction 2
			directions1 = new google.maps.DirectionsService();
			  displayer1 = new google.maps.DirectionsRenderer({
				draggable: false,
				suppressMarkers : true
			  });
			displayer1.setMap(map);
			displayer1.setPanel(document.getElementById("directionsPanel"));
			var ppt1 = [
				wpt[1][1],wpt[1][2],wpt[1][3],wpt[1][4],wpt[1][5],wpt[1][6],wpt[1][7],wpt[1][8]
				]
			directions1.route({
			  origin: new google.maps.LatLng(10.80079, 106.6613),
			  destination: new google.maps.LatLng(10.80079, 106.6613),
			  travelMode: google.maps.DirectionsTravelMode.DRIVING,
			  waypoints: ppt1
			}, function (result) {
			  displayer1.setDirections(result);
			});
			//end direction 2
			//google.maps.event.addListenerOnce(map, 'tilesloaded', addMarkers);
		  }
		  
		   function attachInstructionText(marker, text) {
			google.maps.event.addListener(marker, 'click', function() {
			  // Open an info window when the marker is clicked on,
			  // containing the text of the step.
			  stepDisplay.setContent(text);
			  stepDisplay.open(map, marker);
			});
		  }
		  google.maps.event.addDomListener(window, 'load', initialize);
		

	</script>
</html>
