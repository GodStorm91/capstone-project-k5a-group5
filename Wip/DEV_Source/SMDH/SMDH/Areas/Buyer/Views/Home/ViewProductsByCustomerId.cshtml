@{
    ViewBag.Title = "Index";
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
		Remove this if you use the .htaccess -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>CustomerOrder</title>
    <meta name="description" content="" />
    <meta name="author" content="ngocanh" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link href="/css/bootstrap.css" rel="stylesheet" />
    <link href="/css/bootstrap-responsive.css" rel="stylesheet">
    <script src="/js/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="/js/jquery-ui.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/js/jquery.cookie.js"></script>
    <script type="text/javascript" src="/js/jquery.mousewheel.min.js"></script>
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false&language=vi"></script>
    <script src="/js/jquery.gomap-1.3.2-edited.js" type="text/javascript"></script>
    <script src="/js/map-helper.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="/css/DT_bootstrap.css" />
    <script src="/js/chosen.jquery.js" type="text/javascript"></script>
    <script src="/js/collection-plan-request-ticket.js" type="text/javascript"></script>
    <script src="/js/date.format.js" type="text/javascript"></script>
    <script src="/js/jquery.validate.js" type="text/javascript"></script>
    <script src="/js/bootbox.min.js" type="text/javascript"></script>
    <style> body {
      padding-bottom: 40px;
      color: #5a5a5a;
    }



    /* CUSTOMIZE THE NAVBAR
    -------------------------------------------------- */

    /* Special class on .container surrounding .navbar, used for positioning it into place. */
    .navbar-wrapper {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      z-index: 10;
      margin-top: 20px;
      margin-bottom: -90px; /* Negative margin to pull up carousel. 90px is roughly margins and height of navbar. */
    }
    .navbar-wrapper .navbar {

    }

    /* Remove border and change up box shadow for more contrast */
    .navbar .navbar-inner {
      border: 0;
      -webkit-box-shadow: 0 2px 10px rgba(0,0,0,.25);
         -moz-box-shadow: 0 2px 10px rgba(0,0,0,.25);
              box-shadow: 0 2px 10px rgba(0,0,0,.25);
    }

    /* Downsize the brand/project name a bit */
    .navbar .brand {
      padding: 14px 20px 16px; /* Increase vertical padding to match navbar links */
      font-size: 16px;
      font-weight: bold;
      text-shadow: 0 -1px 0 rgba(0,0,0,.5);
    }

    /* Navbar links: increase padding for taller navbar */
    .navbar .nav > li > a {
      padding: 15px 20px;
    }

    /* Offset the responsive button for proper vertical alignment */
    .navbar .btn-navbar {
      margin-top: 10px;
    }



    /* CUSTOMIZE THE NAVBAR
    -------------------------------------------------- */

    /* Carousel base class */
    .carousel {
      margin-bottom: 60px;
    }

    .carousel .container {
      position: relative;
      z-index: 9;
    }

    .carousel-control {
      height: 80px;
      margin-top: 0;
      font-size: 120px;
      text-shadow: 0 1px 1px rgba(0,0,0,.4);
      background-color: transparent;
      border: 0;
    }

    .carousel .item {
      height: 500px;
    }
    .carousel img {
     
      top: 0;
      left: 0;
     
    }

    .carousel-caption {
      background-color: transparent;
      position: static;
      max-width: 550px;
      padding: 0 20px;
      margin-top: 200px;
    }
    .carousel-caption h1,
    .carousel-caption .lead {
      margin: 0;
      line-height: 1.25;
      color: #fff;
      text-shadow: 0 1px 1px rgba(0,0,0,.4);
    }
    .carousel-caption .btn {
      margin-top: 10px;
    }



    /* MARKETING CONTENT
    -------------------------------------------------- */

    /* Center align the text within the three columns below the carousel */
    .marketing .span4 {
      text-align: center;
    }
    .marketing h2 {
      font-weight: normal;
    }
    .marketing .span4 p {
      margin-left: 10px;
      margin-right: 10px;
    }


    /* Featurettes
    ------------------------- */

    .featurette-divider {
      margin: 80px 0; /* Space out the Bootstrap <hr> more */
    }
    .featurette {
      padding-top: 120px; /* Vertically center images part 1: add padding above and below text. */
      overflow: hidden; /* Vertically center images part 2: clear their floats. */
    }
    .featurette-image {
      margin-top: -120px; /* Vertically center images part 3: negative margin up the image the same amount of the padding to center it. */
    }

    /* Give some space on the sides of the floated elements so text doesn't run right into it. */
    .featurette-image.pull-left {
      margin-right: 40px;
    }
    .featurette-image.pull-right {
      margin-left: 40px;
    }

    /* Thin out the marketing headings */
    .featurette-heading {
      font-size: 50px;
      font-weight: 300;
      line-height: 1;
      letter-spacing: -1px;
    }



    /* RESPONSIVE CSS
    -------------------------------------------------- */

    #media (max-width: 979px) {

      .container.navbar-wrapper {
        margin-bottom: 0;
        width: auto;
      }
      .navbar-inner {
        border-radius: 0;
        margin: -20px 0;
      }

      .carousel .item {
        height: 500px;
      }
      .carousel img {
        width: auto;
        height: 500px;
      }

      .featurette {
        height: auto;
        padding: 0;
      }
      .featurette-image.pull-left,
      .featurette-image.pull-right {
        display: block;
        float: none;
        max-width: 40%;
        margin: 0 auto 20px;
      }
    }
    
    #checkForm label.error
    {
        margin-left: 10px;
        width: auto;
        display: block;
        color: Red
    }


    #media (max-width: 767px) {

      .navbar-inner {
        margin: -20px;
      }

      .carousel {
        margin-left: -20px;
        margin-right: -20px;
      }
      .carousel .container {

      }
      .carousel .item {
        height: 300px;
      }
      .carousel img {
        height: 300px;
      }
      .carousel-caption {
        width: 65%;
        padding: 0 70px;
        margin-top: 100px;
      }
      .carousel-caption h1 {
        font-size: 30px;
      }
      .carousel-caption .lead,
      .carousel-caption .btn {
        font-size: 18px;
      }

      .marketing .span4 + .span4 {
        margin-top: 40px;
      }

      .featurette-heading {
        font-size: 30px;
      }
      .featurette .lead {
        font-size: 18px;
        line-height: 1.5;
      }

    }
   </style>
    <script type="text/javascript">

        function chMd() {
            for (var i = 0; i < document.forms[0].elements.length; i++) {
                if (document.forms[0].elements[i].name == "optionsRadios") {
                    if (document.forms[0].elements[i].value == "option1") {
                        if (document.forms[0].elements[i].checked == true) {
                            $('#ddlHubCategories').prop('disabled', true);
                            $('#ddlHub').prop('disabled', true);
                        }
                    }
                    else if (document.forms[0].elements[i].value == "option2") {
                        if (document.forms[0].elements[i].checked == true) {
                            $('#ddlHubCategories').prop('disabled', false);
                            $('#ddlHub').prop('disabled', false);

                        }
                    }
                }
            }
        }
    </script>
    <script type="text/javascript">

        var goMap;
        var currentHub;
        var currentHouse;
        var hubsMarkerArray = new Array();
        var infowindow;
        function initialize() {
            var myLatlng = new google.maps.LatLng(10.776198, 106.632982);
            var myOptions = {
                zoom: 16,
                center: myLatlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            }
            goMap = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
            // Biến text chứa nội dung sẽ được hiển thị
            var text;

            infowindow = new google.maps.InfoWindow(
        { content: text,
            size: new google.maps.Size(100, 50),
            position: myLatlng
        });
            google.maps.event.addListener(goMap, 'click', function () {
                infowindow.close();
            });

            infowindow.open(goMap);

        }
        function findLocation(tag) {
            var geocoder = new google.maps.Geocoder();
            var address = $(tag).val() + ", Ho Chi Minh, Viet Nam";
            geocoder.geocode({ 'address': address }, function (results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                    goMap.setZoom(18);
                    goMap.setCenter(results[0].geometry.location);
                    goMap.panTo(results[0]);
                } else {
                    alert("Geocoder failed due to: " + status);
                }
            });
        }
        function addMarkerHouse(lat, long) {
            var myLatLng = new google.maps.LatLng(lat, long);
            currentHouse = new google.maps.Marker(
        {
            position: myLatLng,
            map: goMap, title: "House",
            animation: google.maps.Animation.DROP,
            icon: "/img/markers/home.png"
        });

            goMap.setCenter(currentHouse.getPosition());
        }

        function addMarkerHub(lat, long, content) {
            var contentString = content;
            var myLatLng = new google.maps.LatLng(lat, long);
            currentHub = new google.maps.Marker(
        {
            position: myLatLng,
            map: goMap, title: "Hub"
        });

            google.maps.event.addListener(currentHub, 'click', function () {
                infowindow.setContent(contentString);
                infowindow.open(goMap, currentHub);
            });

            return currentHub;
        }

        function addMarkerForMultipleHub(data) {
            $.each(data, function (index, dataItem) {
                var content = "Name : " + dataItem.Name + "<br>" +
                          "Dia chi:" + dataItem.Address;
                var hub = addMarkerHub(dataItem.Latitude, dataItem.Longitude, content);
                hubsMarkerArray.push(hub);
            });
        }

        function removeMarkerHouse() {
            currentHouse = null;
        }

        function removeMarkerHub() {
            currentHub = null;
        }

        function getLatLong(address) {
            var geo = new google.maps.Geocoder;

            geo.geocode({ 'address': address }, function (results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                    return results[0].geometry.location;
                } else {
                    alert("Geocode was not successful for the following reason: " + status);
                }

            });
        }

        var itemIdArray = new Array();
        var quantityArray = new Array();
        var amountArray = new Array();
        function submitInfo() {
            $('.buy_tr').each(function (index) {
                var id = $(this).children("input[type=hidden]").val();
                //alert(id);
                itemIdArray[index] = id;

                quantityArray[index] = $("#quantity" + id).text();

                amountArray[index] = $("#amount" + id).text();

            });
            
            var customerId = $("<input>").attr("type", "hidden").attr("name", "customerId").val(getURLParameter("customerId"));
            var itemsList = $("<input>").attr("type", "hidden").attr("name", "itemsList").val(itemIdArray.toString());
            var quantitiesList = $("<input>").attr("type", "hidden").attr("name", "quantitiesList").val(quantityArray.toString());
            var pricesList = $("<input>").attr("type", "hidden").attr("name", "pricesList").val(amountArray.toString());
            var receiverName = $("<input>").attr("type", "hidden").attr("name", "receiverName").val($('#name').val());
            var receiverAddress = $("<input>").attr("type", "hidden").attr("name", "receiverAddress").val($('#address').val());
            var receiverAddressWardId = $("<input>").attr("type", "hidden").attr("name", "receiverAddressWardId").val("1");
            var receiverAddressDistrictId = $("<input>").attr("type", "hidden").attr("name", "receiverAddressDistrictId").val("1");
            var receiverEmail = $("<input>").attr("type", "hidden").attr("name", "receiverEmail").val($('#email').val());
            var receiverPhone = $("<input>").attr("type", "hidden").attr("name", "receiverPhone").val($('#phone').val());
            var deliveryType = $("<input>").attr("type", "hidden").attr("name", "deliveryType").val("1");
            var totalPrice = $("<input>").attr("type", "hidden").attr("name", "toBeCollectedAmount").val($('#totalPrice').val());
            var hubId = $("<input>").attr("type", "hidden").attr("name", "hubId").val($('#ddlHub').val());
            //alert($('#totalPrice').val());

            //alert($('#address').val());
            var latitude = $("<input>").attr("type", "hidden").attr("name", "latitude").val(localStorage.getItem('HomeLat'));
            var longitude = $("<input>").attr("type", "hidden").attr("name", "longitude").val(localStorage.getItem('HomeLon'));
            //alert("After Home Lat");

            $('#toBeSubmit').append($(itemsList));
            $('#toBeSubmit').append($(quantitiesList));
            //alert("s1");
            $('#toBeSubmit').append($(pricesList));
            //alert("s1");
            $('#toBeSubmit').append($(receiverName));
            $('#toBeSubmit').append($(receiverAddress));
            //alert("s1");
            $('#toBeSubmit').append($(receiverAddressWardId));
            //alert("s1");
            $('#toBeSubmit').append($(receiverAddressDistrictId));
            //alert("s1");
            $('#toBeSubmit').append($(receiverEmail));

            //alert("s1");
            $('#toBeSubmit').append($(receiverPhone));
            //alert("s1");
            $('#toBeSubmit').append($(deliveryType));
            //alert("s1");
            $('#toBeSubmit').append($(totalPrice));
            //alert("s1");
            $('#toBeSubmit').append($(latitude));
            //alert("s1");
            $('#toBeSubmit').append($(longitude));

            $('#toBeSubmit').append($(customerId));
            $('#toBeSubmit').append($(hubId));

            //alert("can append");        

            //alert("form can submit");
            //$('#toBeSubmit').submit();
            $('#checkForm').submit();
        }

        $.validator.setDefaults({
            submitHandler: function () {
                if (itemIdArray.length == 0) {
                    bootbox.alert("You should have at least one item in your cart to submit orders");
                    return;
                }
                $('#toBeSubmit').submit();
            }
        });

        function getURLParameter(name) {
            return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search) || [, ""])[1].replace(/\+/g, '%20')) || null;
        }
    </script>
    <script type="text/javascript">
        var deleteItemManagement = function (itemID) {
            bootbox.confirm("Are you sure to cancel this request?", function (result) {
                if (result) {
                    $.post('/Customer/ItemManagement/Remove/' + itemID, function (result) {
                        if (result.success) {
                            $.blockUI();
                            window.location.reload();
                        } else {
                            bootbox.alert('Failed to cancel this request.');
                        }
                    });
                }
            });
        };
    </script>
    <style type="text/css">
        #noi_dung
        {
            position: absolute;
            background-color: white;
            visibility: hidden;
            z-index: 100;
            border: 1px ridge #0000FF;
            padding: 10px;
            width: 500px;
            text-align: justify;
        }
    </style>
    <script type="text/javascript">
        var totalPrice = 0;
        function DiChuyen(iamgeUrl, des) {
            $('#noi_dung img').attr('src', iamgeUrl);
            $('#noi_dung .des').text(des);
            e = window.even || event;
            s = document.getElementById("noi_dung");

            s.style.top = e.clientY + 'px';
            s.style.visibility = 'visible';
            //document.title = e.clientX + ':' + e.clientY;
        }
        function addCart(tag) {
            var tem = $(tag).parent().parent();
            var inputFiled = tem.children("td").children("input");
            var quantity = inputFiled.val();
            var id = tem.children("input[type=hidden]").val();
            if (!is_numeric(quantity)) {
                alert("Quantity must be a number !!!");
                inputFiled.focus();
                return;
            }
            if (quantity > 100) {
                alert("Quantity must be less than 100!!!");
                inputFiled.focus();
                return;
            }
            if (quantity <= 0) {
                alert("Quantity must be positive integer!!!");
                inputFiled.focus();
                return;
            }
            var flag = true;
            $('.buy_tr').each(function (index) {
                if ($(this).children("input[type=hidden]").val() == id) {
                    var quaTem = $("#quantity" + id).text();
                    var amoTem = $("#amount" + id).text();
                    var finalQuan = parseInt(quaTem) + parseInt(quantity);
                    $("#quantity" + id).text(finalQuan);
                    $("#amount" + id).text(finalQuan *
                            tem.children("td").eq(2).text());
                    flag = false;
                }
            });

            if (flag) {
                var textHtml = '<tr align="center" class="buy_tr"><input class="input-mini" style="text-align:right" type="hidden" value="' +
                    tem.children("input[type=hidden]").val() +
                     '"/><td>' + tem.children("td").eq(1).text() + '</td><td style="text-align:right">' + tem.children("td").eq(2).text() +
                    '</td><td style="text-align:right" id="quantity' + tem.children("input[type=hidden]").val() + '">' +
                    tem.children("td").children("input[type=text]").val() +
				'</td><td style="text-align:right"id="amount' + tem.children("input[type=hidden]").val() + '">' + tem.children("td").eq(2).text() * tem.children("td").children("input").val() +
                '</td><td><button class="btn btn-danger" onclick="removeCart(this)" type="button">Remove</button></td></tr>';
                $('#tblAddCart tbody').append(textHtml);
            }
            totalPrice += tem.children("td").eq(2).text() * tem.children("td").children("input").val();
            $('#totalPrice').val(totalPrice);
            // alert($(tag).parent().parent().prop("tagName"))
        }
        function removeCart(tag) {
            var tem = $(tag).parent().parent();
            tem.remove();
        }
        function is_numeric(input) {
            return !isNaN(input);
        }
        function checkPhone(tag) {
            //            var tem = $(tag);
            //            var patt1 = /^\d{10,13}$/;
            //            // alert($(tag).val());
            //            if (!patt1.test($(tag).val())) {
            //                alert("invalid!Phone must be number!!!");
            //                $(tag).focus();
            //            }
        }
        function checkEmail(tag) {
            //                    var tem = $(tag);
            //                    var patt1 = 
            //                    // alert($(tag).val());
            //                    if (!patt1.test($(tag).val())) {
            //                        alert("sai");
            //                        $(tag).focus();
            //                    }
        }
        $('#btnBuy').live("click", function () {
            var buyArray = new Array();
            $('.buy_tr').each(function (index) {
                var itemArray = new Array();
                itemArray.push($(this).children("input[type=hidden]").val());
                itemArray.push($(this).children("td").children("input[type=text]").val());
                buyArray.push(itemArray);
            });
            $.post('/CustomerOrder/Add', {
                buyArray: buyArray
            }, function (result) {

            });
        });


    </script>
</head>
<body onload="initialize()">
    <form id="toBeSubmit" action="/Buyer/Home/ConfirmCreateOrder" method="post">
    </form>
    <div id="myCarousel" class="carousel slide">
        <!-- Carousel items -->
        <div class="carousel-inner">
            <div class="active item">
                <div class="span12">
                    <div class="span4">
                        <img src="@ViewBag.CompanyInfo.LogoURL" width="100px" height="150px"/>
                        <p style="margin-left: 100px; margin-top: -35px;">
                            <b>@ViewBag.CompanyInfo.CompanyName</b></p>
                    </div>
                    <div class="span5">
                        <div>
                            <div>
                                Total Price :&nbsp;&nbsp;&nbsp;<input class="input-medium" type="text" id="totalPrice"
                                    value="" style="text-align: right; margin-top: 10px;" disabled="disabled"><a href="#BM1"
                                        class="btn btn-link" type="button">Go to Customer Info</a>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid" style="float: left;">
                        <div class="span6">
                            <div class="widget-box">
                                <div class="widget-title">
                                    <span class="icon"><i class="icon-th-list"></i></span>
                                    <h5>
                                        <a name="BM2">Menu</a></h5>
                                </div>
                                <div class="widget-content">
                                    <div style="overflow-y: scroll; height: 400px;">
                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th>
                                                        Image
                                                    </th>
                                                    <th>
                                                        Name
                                                    </th>
                                                    <th>
                                                        Price
                                                    </th>
                                                    <th>
                                                        Quantity
                                                    </th>
                                                    <th>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (var item in Model)
                                                {
                                                    string itemNo = "itemNo" + item.ProductId;
                                                    <tr align="center">
                                                        <input class="input-mini" style="text-align:right" type="hidden" value="@item.ProductId"/>
                                                        <td>
                                                            <img width ="50" height="30"src="@item.ImageURL"onmouseover="DiChuyen('@item.ImageURL','@item.Name')" onmouseout="noi_dung.style.visibility='hidden';"/>
                                                        </td>
                                                        <td>@item.Name
                                                        </td>
                                                        <td style="text-align: right">@item.ProductPrice
                                                        </td>
                                                        <td>
                                                            <input class="input-mini" style="text-align:right" type="text" value="1" id="@itemNo"/>
                                                        </td>
                                                        <td>
                                                            <button class="btn btn-info" type="button" onclick="addCart(this)">
                                                                Add</button>
                                                        </td>
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="span6">
                            <div>
                                <div>
                                    <div class="widget-box">
                                        <div class="widget-title">
                                            <span class="icon"><i class="icon-th-list"></i></span>
                                            <h5>
                                                Cart Add</h5>
                                        </div>
                                        <div class="widget-content">
                                            <div style="overflow-y: scroll; height: 400px;">
                                                <table class="table table-striped" id="tblAddCart" cellpadding="0px">
                                                    <thead>
                                                        <tr>
                                                            <th>
                                                                Name
                                                            </th>
                                                            <th>
                                                                Price
                                                            </th>
                                                            <th>
                                                                Quantity
                                                            </th>
                                                            <th>
                                                                Amount
                                                            </th>
                                                            <th>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="item">
                <div class="span12">
                    <div class="row-fluid">
                        <div class="span6">
                            <div>
                                <div class="widget-box">
                                    <div class="widget-title">
                                        <span class="icon"><i class="icon-th-list"></i></span>
                                        <h5>
                                            <a name="BM1">Customer Infor</a></h5>
                                    </div>
                                    <div class="widget-content">
                                        <form class="form-horizontal" id="checkForm" action="" method="get">
                                        <div class="control-group">
                                            <label class="control-label" for="name">
                                                Name(*)</label>
                                            <div class="controls">
                                                <input type="text" id="name" name="name">
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label" for="phone">
                                                Phone(*)
                                            </label>
                                            <div class="controls">
                                                <input type="text" id="phone" name="phone" onchange="checkPhone(this)">
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label" for="email">
                                                Email(*)</label>
                                            <div class="controls">
                                                <input type="email" id="email" name="email" placeholder="email" />
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label" for="city">
                                                City(*)</label>
                                            <div class="controls">
                                                @Html.DropDownList("CityProvinceId", ViewBag.City as SelectList, "-- Choose a City or Province --", new { id = "ddlCityProvince", Class = "chzn-select", name = "city" })
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label" for="district">
                                                District(*)</label>
                                            <div class="controls">
                                                @Html.DropDownList("DistrictId", ViewBag.District as SelectList, "-- Choose a District --", new { id = "ddlDistrict", Class = "chzn-select", name = "district" })
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label" for="ward">
                                                Ward(*)</label>
                                            <div class="controls">
                                                @*@Html.DropDownList("Ward", ViewBag.Ward as SelectList, "-- Choose a Ward --", new { id = "ddlWard", Class = "chzn-select", name = "ward" })*@
                                                <input type="text" class="search" name="ddlWard" placeholder="Search for ward" onblur="hideWard()" onkeyup="searchWard(this.value)">
                                                    <div class="result-widget">
                                <!--                    <ul>
                                            <li><a href="" data-isbn="9780545317801"><div>
                                                <img class="coverUrl" src="http://goo.gl/83T3v">
                                                <div class="desc">
                                                    <div class="title">A Novel: The Last Man on Earth</div>
                                                    <div class="author">Vince Flynn</div>
                                                </div>
                                            </div></a></li>
                                        </ul>-->
                                                    </div>
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label" for="address">
                                                Address</label>
                                            <div class="controls">
                                                <input name="address" type="text" id="address" onchange="findLocation(this)" />
                                            </div>
                                        </div>
                                        <form>
                                        <div>
                                            <label class="radio inline">
                                                <input type="radio" name="optionsRadios" onclick="chMd()" id="optionsRadios1" value="option1">
                                                Direct Delivery
                                            </label>
                                            <label class="radio inline">
                                                <input type="radio" name="optionsRadios" onclick="chMd()" id="optionsRadios2" value="option2"
                                                    checked>
                                                Buffer Delivery
                                            </label>
                                        </div>
                                        <div class="control-group" name="">
                                            <label class="control-label" for="allHubs">
                                            </label>
                                            <div class="controls">
                                                @Html.DropDownList("HubCategory", ViewBag.HubCategories as SelectList, "-- Choose a Hub Type --", new { id = "ddlHubCategories", Class = "chzn-select" })
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label" for="aroundHubs">
                                                Around Hubs</label>
                                            <div class="controls">
                                                @Html.DropDownList("Hub", ViewBag.Hubs as SelectList, "-- Choose a Hub --", new { id = "ddlHub", Class = "chzn-select" })
                                            </div>
                                        </div>
                                        </form>
                                        <div style="margin-left: 160px;">
                                            <form class="form-inline">
                                            <button type="button" class="btn-success" onclick="submitInfo()">
                                                OK</button>
                                            <button type="button" class=" btn-warning">
                                                Cancel</button>
                                            <a href="#BM2" class="btn btn-link" type="button">Go to Menu</a>
                                            </form>
                                        </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="span6">
                            <div class="widget-box">
                                <div class="widget-title">
                                    <span class="icon"><i class="icon-th-list"></i></span>
                                    <h5>
                                        Map</h5>
                                </div>
                                <div class="widget-content">
                                    <div id="map_canvas" style="height: 575px;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Carousel nav -->
            <a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
            <a class="carousel-control right" href="#myCarousel" data-slide="next">&rsaquo;</a>
        </div>
        <p>
            <div id="noi_dung" style="margin-left: 60px; margin-top: -10px; width: 500px; height: 300px;">
                <img src="" width="150px" height="150px" style="float: left; margin-left: 10px;" /><div
                    class="des" style="float: left; margin-left: 50px; margin-top: 50px;">
                </div>
            </div>
        </p>
        <script src="/js/bootstrap-carousel.js" type="text/javascript"></script>
        <script>
            !function ($) {
                $(function () {
                    // carousel demo
                    $('#myCarousel').carousel()
                })
            } (window.jQuery)
        </script>
        <script>
            function hideWard() {
                $('.result-widget').html("");
            }

            function searchWard(chars) {
                $.post('/Ward/GetWardsFromDistrictIdAndChars', { id: chars, str: $('#txtWard').value() }, function (data) {
                    
                });
            }

            function changeHubCategoriesHandler() {
                var items = '<option value="-1">-- All Locations --</option>';
                $('#ddlHub').html(items);
                $('#ddlHub').trigger("change");
                var hubId = -1;
                var hubLists = null;
                if (arguments[0]) {
                    hubId = arguments[0];
                }
                var id = $('#ddlHubCategories option:selected').val();
                if (id == '') id = -1;
                //alert(id);
                $.getJSON('/HubCategories/GetHubsByHubCategory/' + id, function (data) {
                    items = '<option value="-1">-- All Locagions --</option>';
                    $.each(data, function (i, hub) {
                        items += "<option value='" + hub.HubId + "'>" + hub.Name + "</option>";
                        //alert(hub.HubId);
                    });
                    $('#ddlHub').html(items);
                    $('#ddlHub').trigger("liszt:updated");
                    $('#ddlHub').val(hubId);

                    if (hubId == -1) {
                        clearOverlays();
                        addMarkerForMultipleHub(data);
                    }

                });

            }

            $("#ddlHubCategories").change(function () {
                changeHubCategoriesHandler();
            });

            $("#ddlHub").change(function () {
                //CLEAR MOI OVERLAYS
                clearOverlays();

                //DROP LAI Pins + tu focus den pin da co
                var id = $('#ddlHub option:selected').val();
                $.getJSON('/Hubs/Find/' + id, function (data) {
                    var content = "Name : " + data.Name + "<br>" +
                          "Dia chi:" + data.Address;
                    addMarkerHub(data.Latitude, data.Longitude, content, true, data.HubId);
                });
            });

            $("#ddlCityProvince").change(function () {
                var items = '<option value="-1">-- All Districts --</option>';
                $('#ddlDistrict').html(items);
                $('#ddlDistrict').trigger("change");
                var id = $('#ddlCityProvince option:selected').val();

                if (id == '') id = -1;
                $.getJSON('/District/GetDistrictsOfCityProvince/' + id, function (data) {
                    items = '<option value="-1">-- All Districts --</option>';
                    $.each(data, function (i, district) {
                        items += "<option value='" + district.DistrictId + "'>" + district.Name + "</option>";
                    });
                    $('#ddlDistrict').html(items);
                    $('#ddlDistrict').trigger("liszt:updated");
                });
            });

            $("#ddlDistrict").change(function () {
                var items = '<option value="-1">-- All Wards --</option>';
                $('#ddlWard').html(items);
                $('#ddlWard').trigger("change");
                var id = $('#ddlDistrict option:selected').val();
                if (id == '') id = -1;
                $.getJSON('/Ward/GetWardsOfDistrict/' + id, function (data) {
                    items = '<option value="-1">-- All Wards --</option>';
                    $.each(data, function (i, ward) {
                        items += "<option value='" + ward.WardId + "'>" + ward.Name + "</option>";
                    });
                    $('#ddlWard').html(items);
                });
            });

            $('#address').blur(function () {
                findLocation();
            });

            function clearOverlays() {
                if (hubsMarkerArray.length > 0) {
                    for (var i = 0; i < hubsMarkerArray.length; i++) {
                        hubsMarkerArray[i].setMap(null);
                    }
                }
            }


            function findLocation() {
                var address = $('#address').val();
                if (address.length == 0) return;
                $.post("/Buyer/Home/GetLatitudeAndLongitudeFromAddress", { address: address }, function (data) {
                    var content = "Name : " + data.nearestHub.Name + "<br>" +
                          "Dia chi:" + data.nearestHub.Address;

                    addMarkerHouse(data.lat, data.lon);
                    localStorage.setItem('HomeLat', data.lat);
                    localStorage.setItem('HomeLon', data.lon);
                    //alert(data.HubId);
                    addMarkerHub(data.nearestHub.Latitude, data.nearestHub.Longitude, content, false, data.nearestHub.HubId);
                    setTimeout(function () { goMap.panTo(new google.maps.LatLng(data.nearestHub.Latitude, data.nearestHub.Longitude)); }, 5000);
                    $('#ddlHubCategories').val(data.nearestHub.HubCategoryId);
                    var id = 8
                    id = data.nearestHub.HubId;
                    //alert(id);
                    changeHubCategoriesHandler(id);
                });
            }

            $().ready(function () {
                $("#checkForm").validate({
                    rules: {
                        email: {
                            required: true,
                            email: true
                        },
                        phone: {
                            digits: true,
                            minlength: 10,
                            maxlength: 12,
                            required: true
                        },
                        name: "required",
                        CityProvinceId: {
                            min: 0,
                            required: true
                        },
                        DistrictId: {
                            min: 0,
                            required: true
                        },
                        Ward: {
                            min: 0,
                            required: true
                        },
                        HubCategory: {
                            min: 0,
                            required: "#optionsRadios2:checked"
                        },
                        Hub: {
                            min: 0,
                            required: "#optionsRadios2:checked"
                        },
                        address: {
                            required: true
                        }

                    },
                    messages: {
                        email: {
                            email: "Please enter a valid email address",
                            required: "Please enter your email address"
                        },
                        phone: {
                            digits: "Please enter digits not character",
                            minlength: "The minimum of cell phone digits is 10",
                            maxlength: "The maximum of cell phone digits is 12",
                            required: "Please enter your phone number"
                        },
                        name: "Please enter your name!",
                        CityProvinceId: {
                            min: "Please choose city",
                            required: "Please choose city"
                        },
                        DistrictId: {
                            min: "Please choose district",
                            required: "Please choose district"
                        },
                        Ward: {
                            required: "Please choose ward",
                            min: "Please choose ward"
                        },
                        Hub: {
                            required: "Please choose Hub",
                            min: "Please choose hub"
                        },
                        HubCategory: {
                            required: "Please choose Hub Category",
                            min: "Please choose Hub category"
                        },
                        address: "Please enter address"

                    }
                });

            });           

        </script>
</body>
</html>
