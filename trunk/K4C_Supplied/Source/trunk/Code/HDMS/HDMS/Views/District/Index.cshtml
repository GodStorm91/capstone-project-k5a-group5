@model IEnumerable<HDMS.Models.District>
@{
    ViewBag.Title = "Districts";
    ViewBag.Heading = "Districts";
}
@if (false)
{ 
    <script src="/js/jquery-1.8.2-vsdoc.js" type="text/javascript"></script>
}
<link rel="stylesheet" type="text/css" href="/css/DT_bootstrap.css" />
<link href="/css/dataTables.bootstrap.css" rel="stylesheet" type="text/css" />
<script src="/js/jquery.dataTables.js" type="text/javascript"></script>
<script type="text/javascript" charset="utf-8" language="javascript" src="/js/DT_bootstrap.js"></script>
<script src="/js/dataTables.bootstrap.js" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<script src="/js/crud.js" type="text/javascript"></script>
<script>
    $(document).ready(function () {
        setupCrud('District');
    });
</script>
<table class="table table-striped table-bordered" id="main-table">
    <thead>
        <tr>
            <th>
                District
            </th>
            <th>
                City/Province
            </th>
            <th class="tbl-action-col">
                Action
            </th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @item.Name
                </td>
                <td>
                    @(item.CityProvince.IsActive == false ? "None" : item.CityProvince.Name)
                </td>
                <td class="">
                    <a class="btn action edit" href="javascript:void(0)" onclick="edit(@item.DistrictId)">
                        <img src="/img/icons/pencil.png" alt="Edit" title="Edit" width="15px" />
                    </a><a class="btn action delete" href="#" onclick="deleteDistrict(@item.DistrictId);">
                        <img src="/img/icons2/cross.png" alt="Delete" title="Delete" width="15px" />
                    </a>
                </td>
            </tr> 
        }
    </tbody>
</table>
<!-- Begin "Create" Modal -->
<div class="modal hide fade" id="createModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
    aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
            ×</button>
        <h3 id="myModalLabel">
            Create new District</h3>
    </div>
    <div class="modal-body">
        @using (Html.BeginForm("Create", "District", FormMethod.Post, new { id = "create-form" }))
        {
            @Html.ValidationSummary(true)
            <fieldset>
                <div class="editor-label">
                    City/Province
                </div>
                <div class="editor-field">
                    @Html.DropDownListFor(model => Model.FirstOrDefault().CityProvinceId, ((IEnumerable<HDMS.Models.CityProvince>)ViewBag.PossibleCiTyProvinces).Select(option => new SelectListItem
               {
                   Text = (option == null ? "None" : option.Name),
                   Value = option.CityProvinceId.ToString(),
                   Selected = (Model.FirstOrDefault() != null) && (option.CityProvinceId == Model.FirstOrDefault().CityProvinceId)
               }), "-- Choose a City/Province --")
                    @Html.ValidationMessageFor(model => Model.FirstOrDefault().CityProvinceId)
                </div>
                <div class="editor-label">
                    @Html.LabelFor(model => Model.FirstOrDefault().Name)
                </div>
                <div class="editor-field">
                    @Html.EditorFor(model => Model.FirstOrDefault().Name)
                    @Html.ValidationMessageFor(model => Model.FirstOrDefault().Name)
                </div>
                <div class="modal-footer">
                    <button class="btn" data-dismiss="modal" aria-hidden="true">
                        Cancel</button>
                    <input type="submit" class="btn btn-primary" value="Create" />
                </div>
            </fieldset>    
        }
    </div>
</div>
<!-- End "Create" Modal -->
<!-- Begin "Edit" Modal -->
<div class="modal hide fade" id="editModal">
</div>
<!-- End "Edit" Modal -->
<button id="btnPrint">
    Print</button>
<script type="text/javascript">
    $(document).ready(function () {
        $('#btnPrint').click(function () {
            debugger
            $('.header-top').toggle();
            $('.sidebar-container').toggle();
            window.print(function () { return false; });
            $('.header-top').toggle();
            $('.sidebar-container').toggle();
        });
    });
</script>
<script type="text/javascript">
    var deleteDistrict = function (districtId) {
        bootbox.confirm("Are you sure to delete this district?", function (result) {
            if (result) {
                $.post('/District/Remove/' + districtId, function (result) {
                    if (result.success) {
                        $.blockUI();
                        window.location.reload();
                    } else {
                        bootbox.alert('Unable to delete this district');
                    }
                });
            }
        });
    };
</script>
